<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>cMail</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"><link rel="home" href="index.html" title="Talend Open Studio"><link rel="up" href="ch03.html" title="Chapitre&nbsp;3.&nbsp;Composants Messaging"><link rel="prev" href="cJMS.html" title="cJMS"><link rel="next" href="cMessagingEndpoint.html" title="cMessagingEndpoint"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div lang="fr" class="section" title="cMail"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cMail"></a>cMail</h2></div></div></div><div class="mediaobject"><img src="../images/cmail_icon32_white.png"></div><div class="section" title="Propri&eacute;t&eacute;s du cMail"><div class="titlepage"><div><div><h3 class="title"><a name="d0e6075"></a>Propri&eacute;t&eacute;s du cMail</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><tbody><tr><td valign="top">
                            <p><span class="bold"><strong>Famille de composant</strong></span></p>
                        </td><td valign="top">
                            <p>Messaging </p>
                        </td><td valign="top">&nbsp;</td></tr><tr><td valign="top">
                            <p><span class="bold"><strong>Fonction</strong></span></p>
                        </td><td colspan="2" valign="top">
                            <p>Le composant <span class="bold"><strong>cMail</strong></span> est cr&eacute;&eacute; pour
                                envoyer ou recevoir des e-mails.</p>
                        </td></tr><tr><td valign="top">
                            <p><span class="bold"><strong>Objectif</strong></span></p>
                        </td><td colspan="2" valign="top">
                            <p>Envoie ou re&ccedil;oit des e-mails dans une route.</p>
                        </td></tr><tr><td valign="top">
                            <p><span class="bold"><strong>Basic settings</strong></span></p>
                        </td><td valign="top">
                            <p><span class="emphasis"><em>Protocols</em></span></p>
                        </td><td valign="top">
                            <p>Liste des protocoles d'envoi ou de r&eacute;ception d'e-mails.</p>
                        </td></tr><tr><td>
                            <p>&nbsp;</p>
                        </td><td valign="top">
                            <p><span class="emphasis"><em>Host</em></span></p>
                        </td><td valign="top">
                            <p>Nom de l'h&ocirc;te du serveur d'e-mail.</p>
                        </td></tr><tr><td>
                            <p>&nbsp;</p>
                        </td><td valign="top">
                            <p><span class="emphasis"><em>Port</em></span></p>
                        </td><td valign="top">
                            <p>Num&eacute;ro de port du serveur d'e-mail.</p>
                        </td></tr><tr><td>
                            <p>&nbsp;</p>
                        </td><td valign="top">
                            <p><span class="emphasis"><em>UserName</em></span> et
                                <span class="emphasis"><em>Password</em></span></p>
                        </td><td valign="top">
                            <p>Informations d'authentification, respectivement l'identifiant et
                                le mot de passe.</p>
                        </td></tr><tr><td>
                            <p>&nbsp;</p>
                        </td><td valign="top">
                            <p><span class="emphasis"><em>Subject</em></span></p>
                        </td><td valign="top">
                            <p>Sujet du mail &agrave; envoyer.</p>
                        </td></tr><tr><td>
                            <p>&nbsp;</p>
                        </td><td valign="top">
                            <p><span class="emphasis"><em>Content Type</em></span></p>
                        </td><td valign="top">
                            <p>Type de contenu de l'e-mail.</p>
                        </td></tr><tr><td>
                            <p>&nbsp;</p>
                        </td><td valign="top">
                            <p><span class="emphasis"><em>From</em></span></p>
                        </td><td valign="top">
                            <p>&Eacute;metteur de l'e-mail.</p>
                        </td></tr><tr><td>
                            <p>&nbsp;</p>
                        </td><td valign="top">
                            <p><span class="emphasis"><em>To </em></span></p>
                        </td><td valign="top">
                            <p>Destinataire(s) de l'e-mail.</p>
                        </td></tr><tr><td>
                            <p>&nbsp;</p>
                        </td><td valign="top">
                            <p><span class="emphasis"><em>CC</em></span></p>
                        </td><td valign="top">
                            <p>Les destinataires en CC de l'e-mail. Vous pouvez saisir
                                diff&eacute;rentes adresses e-mail en les s&eacute;parant par une virgule.</p>
                        </td></tr><tr><td>
                            <p>&nbsp;</p>
                        </td><td valign="top">
                            <p><span class="emphasis"><em>BCC</em></span></p>
                        </td><td valign="top">
                            <p>Les destinataires en CCI de l'e-mail. Vous pouvez saisir
                                diff&eacute;rentes adresses e-mail en les s&eacute;parant par une virgule.</p>
                        </td></tr><tr><td valign="top">
                            <p><span class="bold"><strong>Advanced settings</strong></span></p>
                        </td><td valign="top">
                            <p><span class="emphasis"><em>Arguments</em></span></p>
                        </td><td valign="top">
                            <p>Cliquez sur le bouton <span class="bold"><strong>[+]</strong></span> pour
                                ajouter les lignes n&eacute;cessaires &agrave; la table <span class="bold"><strong>Arguments</strong></span>. Saisissez le nom et la valeur d'un
                                argument pour chaque ligne ajout&eacute;e.</p>
                        </td></tr><tr><td valign="top">
                            <p><span class="bold"><strong>Utilisation</strong></span></p>
                        </td><td colspan="2" valign="top">
                            <p>Lorsqu'il est utilis&eacute; comme composant de d&eacute;but, le <span class="bold"><strong>cMail</strong></span> est con&ccedil;u pour recevoir des
                                e-mails. Sinon, il est con&ccedil;u pour en envoyer.</p>
                        </td></tr><tr><td valign="top">
                            <p><span class="bold"><strong>Limitation</strong></span></p>
                        </td><td colspan="2" valign="top">
                            <p>n/a</p>
                        </td></tr></tbody></table></div></div><div class="section" title="Sc&eacute;nario : Utiliser un composant cMail pour envoyer et recevoir des e-mails"><div class="titlepage"><div><div><h3 class="title"><a name="d0e6349"></a>Sc&eacute;nario : Utiliser un composant cMail pour envoyer et recevoir des e-mails</h3></div></div></div><p>Ce sc&eacute;nario comprend deux routes. La premi&egrave;re envoie un e-mail et la seconde le
            re&ccedil;oit.</p><p>Construisez la route pour envoyer l'e-mail.</p><div class="procedure" title="Proc&eacute;dure&nbsp;3.10.&nbsp;Envoyer un e-mail"><a name="d0e6356"></a><p class="title"><b>Proc&eacute;dure&nbsp;3.10.&nbsp;Envoyer un e-mail </b></p><ol class="procedure" type="1"><li class="step" title="&Eacute;tape 1"><p>D&eacute;posez les composants suivants de la <span class="bold"><strong>Palette</strong></span>
                    dans l'espace de mod&eacute;lisation graphique : un <span class="bold"><strong>cFile</strong></span>, un <span class="bold"><strong>cMail</strong></span> et un <span class="bold"><strong>cProcessor</strong></span>, respectivement nomm&eacute;s <span class="bold"><strong>Mail_to_send</strong></span>, <span class="bold"><strong>Send_Mail</strong></span> et <span class="bold"><strong>Mail_Sent</strong></span>. </p></li><li class="step" title="&Eacute;tape 2"><p>Reliez les composants &agrave; l'aide de liens <span class="bold"><strong>Row</strong></span> &gt;
                        <span class="bold"><strong>Route</strong></span>.</p><div class="mediaobject"><img src="../images/use_case_cmail_1.png"></div></li><li class="step" title="&Eacute;tape 3"><p>Double-cliquez sur le <span class="bold"><strong>cFile</strong></span> pour ouvrir sa
                    vue <span class="bold"><strong>Basic settings</strong></span>. </p><div class="mediaobject"><img src="../images/use_case_cmail_2.png"></div></li><li class="step" title="&Eacute;tape 4"><p>Cliquez sur le bouton <span class="bold"><strong>[...]</strong></span> &agrave; c&ocirc;t&eacute; du champ
                        <span class="bold"><strong>Path</strong></span> afin de s&eacute;lectionner dans votre
                    syst&egrave;me le dossier contenant le fichier &agrave; envoyer. </p></li><li class="step" title="&Eacute;tape 5"><p>Dans le champ <span class="bold"><strong>FileName</strong></span>, saisissez le nom du
                    fichier &agrave; envoyer, <span class="italic">test mail.txt</span> dans cet
                    exemple. Laissez les autres param&egrave;tres tels qu'ils sont.</p><p>Le contenu de ce fichier est <span class="italic">test mail
                    body</span>.</p></li><li class="step" title="&Eacute;tape 6"><p>Double-cliquez sur le <span class="bold"><strong>cMail</strong></span> afin d'ouvrir sa
                    vue <span class="bold"><strong>Basic settings</strong></span>. </p><div class="mediaobject"><img src="../images/use_case_cmail_3.png"></div></li><li class="step" title="&Eacute;tape 7"><p>Dans la liste <span class="bold"><strong>Protocols</strong></span>, s&eacute;lectionnez
                        <span class="italic">smtps</span>.</p><p>Dans le champ <span class="bold"><strong>Host</strong></span>, saisissez le nom de
                    l'h&ocirc;te du serveur SMTP, <span class="italic">smtp.gmail.com</span> dans
                    ce sc&eacute;nario.</p><p>Dans les champs <span class="bold"><strong>UserName</strong></span> et <span class="bold"><strong>Password</strong></span>, saisissez les informations
                    d'authentification, sous forme de variables de contexte dans cet exemple. Pour
                    plus d'informations concernant la configuration des variables de contexte,
                    consultez le <span class="italic">Guide utilisateur de</span>
                    <span class="bluebold">Talend Open Studio for ESB</span>.</p><p>Laissez le champ <span class="bold"><strong>ContentType</strong></span> par d&eacute;faut,
                    c'est-&agrave;-dire <span class="italic">text/plain</span>.</p><p>Dans le champ <span class="bold"><strong>To</strong></span>, saisissez l'adresse e-mail
                    du destinataire. Dans ce sc&eacute;nario, saisissez la variable de contexte
                    correspondante.</p></li><li class="step" title="&Eacute;tape 8"><p>Double-cliquez sur le <span class="bold"><strong>cProcessor</strong></span> pour ouvrir
                    sa vue <span class="bold"><strong>Basic settings</strong></span>.</p><div class="mediaobject" align="center"><img src="../images/use_case_cmail_4.png" align="middle"></div></li><li class="step" title="&Eacute;tape 9"><p>Dans le champ <span class="bold"><strong>Code</strong></span>, saisissez le code
                    ci-dessous afin d'afficher une fen&ecirc;tre pop-up lorsque l'e-mail est
                    envoy&eacute;.</p><p>
                    </p><pre class="programlisting">System.out.println("Mail sent");</pre><p>
                </p></li><li class="step" title="&Eacute;tape 10"><p>Sauvegardez votre route et appuyez sur <span class="bold"><strong>F6</strong></span>
                    pour l'ex&eacute;cuter.</p><div class="mediaobject" align="center"><img src="../images/use_case_cmail_5.png" align="middle"></div></li></ol></div><p>Comme affich&eacute; ci-dessus, l'e-mail a bien &eacute;t&eacute; envoy&eacute;.</p><p>Construisez la route recevant l'e-mail.</p><div class="procedure" title="Proc&eacute;dure&nbsp;3.11.&nbsp;Recevoir un e-mail"><a name="d0e6523"></a><p class="title"><b>Proc&eacute;dure&nbsp;3.11.&nbsp;Recevoir un e-mail </b></p><ol class="procedure" type="1"><li class="step" title="&Eacute;tape 1"><p>D&eacute;posez les composants suivants de la <span class="bold"><strong>Palette</strong></span>
                    dans l'espace de mod&eacute;lisation graphique : un <span class="bold"><strong>cMail</strong></span> et un <span class="bold"><strong>cProcessor</strong></span>,
                    respectivement nomm&eacute;s <span class="bold"><strong>Receive_Mail</strong></span> et <span class="bold"><strong>Mail_Body</strong></span>. </p></li><li class="step" title="&Eacute;tape 2"><p>Reliez les composants &agrave; l'aide d'un lien <span class="bold"><strong>Row</strong></span>
                    &gt; <span class="bold"><strong>Route</strong></span>.</p><div class="mediaobject"><img src="../images/use_case_cmail_6.png"></div></li><li class="step" title="&Eacute;tape 3"><p>Double-cliquez sur le <span class="bold"><strong>cMail</strong></span> afin d'ouvrir sa
                    vue <span class="bold"><strong>Basic settings</strong></span>. </p><div class="mediaobject"><img src="../images/use_case_cmail_7.png"></div></li><li class="step" title="&Eacute;tape 4"><p>Dans la liste <span class="bold"><strong>Protocols</strong></span>, s&eacute;lectionnez
                        <span class="italic">imaps</span>.</p></li><li class="step" title="&Eacute;tape 5"><p>Dans le champ <span class="bold"><strong>Host</strong></span>, saisissez le nom de
                    l'h&ocirc;te du serveur imap, <span class="italic">imap.gmail.com</span> dans
                    cet exemple.</p></li><li class="step" title="&Eacute;tape 6"><p>Dans le champ <span class="bold"><strong>Port</strong></span>, saisissez le num&eacute;ro du
                    port, <span class="italic">993</span> dans ce sc&eacute;nario.</p></li><li class="step" title="&Eacute;tape 7"><p>Dans les champs <span class="bold"><strong>UserName</strong></span> et <span class="bold"><strong>Password</strong></span>, saisissez les informations
                    d'authentification, sous forme de variables de contexte dans cet exemple. Pour
                    plus d'information  concernant la configuration des variables de contexte,
                    consultez le<span class="italic"> Guide utilisateur de</span>
                    <span class="bluebold">Talend Open Studio for ESB</span>.</p></li><li class="step" title="&Eacute;tape 8"><p>Laissez le champ <span class="bold"><strong>ContentType</strong></span> par d&eacute;faut,
                    c'est-&agrave;-dire <span class="italic">text/plain</span>.</p></li><li class="step" title="&Eacute;tape 9"><p>Double-cliquez sur le <span class="bold"><strong>cProcessor</strong></span> pour ouvrir
                    sa vue <span class="bold"><strong>Basic settings</strong></span>. </p><div class="mediaobject"><img src="../images/use_case_cmail_8.png"></div></li><li class="step" title="&Eacute;tape 10"><p>Dans le champ <span class="bold"><strong>Code</strong></span>, saisissez le code
                    ci-dessous afin d'afficher le corps du message.</p><p>
                    </p><pre class="programlisting">System.out.println(exchange.getIn().getBody(String.class));</pre><p>
                </p></li><li class="step" title="&Eacute;tape 11"><p>Sauvegardez la route et appuyez sur <span class="bold"><strong>F6</strong></span> pour
                    l'ex&eacute;cuter.</p><div class="mediaobject"><img src="../images/use_case_cmail_9.png"></div><p>Comme affich&eacute; ci-dessus, l'e-mail a bien &eacute;t&eacute; re&ccedil;u et son contenu est <span class="italic">test mail body</span>.</p></li></ol></div></div></div></body></html>