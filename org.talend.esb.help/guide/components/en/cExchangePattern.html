<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>cExchangePattern</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"><link rel="home" href="index.html" title="Talend Open Studio"><link rel="up" href="ch05.html" title="Chapter&nbsp;5.&nbsp;Processor components"><link rel="prev" href="cDelayer.html" title="cDelayer"><link rel="next" href="cJavaDSLProcessor.html" title="cJavaDSLProcessor"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div lang="EN" class="section" title="cExchangePattern"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cExchangePattern"></a>cExchangePattern</h2></div></div></div><div class="mediaobject"><img src="../images/cexchangepattern_icon32.png"></div><div class="section" title="cExchangePattern properties"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9270"></a>cExchangePattern properties</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><tbody><tr><td valign="top">
							<p>
								<span class="bold"><strong>Component Family</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>Processor</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="bold"><strong>Function</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>
								<span class="bold"><strong>cExchangePattern</strong></span> can be configured
								to indicate the message exchange mode.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="bold"><strong>Purpose</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>
								<span class="bold"><strong>cExchangePattern</strong></span> allows you to set
								the message exchange mode.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="bold"><strong>Basic settings</strong></span>
							</p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Exchange Patterns</em></span>
							</p>
						</td><td valign="top">
							<p>Select the message exchange mode from <span class="bold"><strong>InOnly</strong></span> or <span class="bold"><strong>InOptionalOut</strong></span>, <span class="bold"><strong>InOut</strong></span>, <span class="bold"><strong>OutIn</strong></span>,
									<span class="bold"><strong>OutOptionalIn</strong></span>, <span class="bold"><strong>RobustInOnly</strong></span>, <span class="bold"><strong>RobustOutOnly</strong></span>.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="bold"><strong>Usage</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>As a middle component in a Route, <span class="bold"><strong>cExchangePattern</strong></span> allows you to set the message
								exchange mode.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="bold"><strong>Limitation</strong></span>
							</p>
						</td><td colspan="2">
							<p>&nbsp;</p>
						</td></tr></tbody></table></div></div><div class="section" title="Scenario: Enabling the InOut exchange pattern to get replies"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9401"></a>Scenario: Enabling the InOut exchange pattern to get replies</h3></div></div></div><p>In this scenario, a <span class="bold"><strong>cExchangePattern</strong></span> component is
			used to enable the request/reply exchange pattern in the Route, so that the client can
			get a reply from the server. </p><div class="mediaobject" align="center"><img src="../images/use_case_cexchangepattern_1.png" align="middle"></div><p>To send requests to the server side, a soapUI is needed and its configuration will be
			briefed in the following contents. </p><p>To build the Route, do the following. </p><div class="section" title="Dropping and linking the components"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9416"></a>Dropping and linking the components </h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>From the <span class="bold"><strong>Processor</strong></span> folder of the <span class="bold"><strong>Palette</strong></span>, drag and drop a <span class="bold"><strong>cCXF</strong></span>, a <span class="bold"><strong>cExchangePattern</strong></span> and a <span class="bold"><strong>cProcessor</strong></span> onto the workspace, and label them <span class="italic">WebService_producer</span>, <span class="italic">Set_exchange_mode</span> and <span class="italic">Build_reply_message</span> respectively to better identify their roles in the Route.</p></li><li class="step" title="Step 2"><p>Link <span class="bold"><strong>cCXF</strong></span> to <span class="bold"><strong>cExchangePattern</strong></span> using a <span class="bold"><strong>Row</strong></span> &gt; <span class="bold"><strong>Route</strong></span>
						connection.</p></li><li class="step" title="Step 3"><p>Link <span class="bold"><strong>cExchangePattern</strong></span> to <span class="bold"><strong>cProcessor</strong></span> using a <span class="bold"><strong>Row</strong></span> &gt; <span class="bold"><strong>Route</strong></span>
						connection.</p></li></ol></div></div><div class="section" title="Configuring the components"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9477"></a>Configuring the components </h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click <span class="bold"><strong>cCXF</strong></span> to open its <span class="bold"><strong>Basic settings</strong></span> view in the <span class="bold"><strong>Component</strong></span> tab. </p><div class="mediaobject" align="center"><img src="../images/use_case_cexchangepattern_2.png" align="middle"></div></li><li class="step" title="Step 2"><p>In the <span class="bold"><strong>Address</strong></span> field, leave the default
						setting unchanged. </p></li><li class="step" title="Step 3"><p>In the <span class="bold"><strong>Type</strong></span> list, select <span class="bold"><strong>wsdlURL</strong></span>. </p></li><li class="step" title="Step 4"><p>In the <span class="bold"><strong>WSDL File</strong></span> field, enter the URL of
						the wsdl file. You can also click the three-dot button to browse for
						it.</p></li><li class="step" title="Step 5"><p>In the <span class="bold"><strong>Dataformat</strong></span> list, select <span class="bold"><strong>PAYLOAD</strong></span>. </p></li><li class="step" title="Step 6"><p>Double-click <span class="bold"><strong>cExchangePattern</strong></span> to open its
							<span class="bold"><strong>Basic settings</strong></span> view in the <span class="bold"><strong>Component</strong></span> tab. </p><div class="mediaobject" align="center"><img src="../images/use_case_cexchangepattern_3.png" align="middle"></div></li><li class="step" title="Step 7"><p>In the <span class="bold"><strong>Exchange Patterns</strong></span> list, select
							<span class="bold"><strong>InOut</strong></span> to enable the request/reply
						message exchange mode.</p></li><li class="step" title="Step 8"><p>Double-click <span class="bold"><strong>cProcessor</strong></span> to open its
							<span class="bold"><strong>Basic settings</strong></span> view in the <span class="bold"><strong>Component</strong></span> tab. </p><div class="mediaobject" align="center"><img src="../images/use_case_cexchangepattern_4.png" align="middle"></div></li><li class="step" title="Step 9"><p>In the <span class="bold"><strong>Code</strong></span> box, enter the code
						below.</p><p>
						</p><pre class="programlisting">StringBuilder sb = new StringBuilder();
sb.append("&lt;tns:getAirportInformationByISOCountryCodeResponse xmlns:tns=\"http://airportsoap.sopera.de\"&gt;");
sb.append("&lt;tns:getAirportInformationByISOCountryCodeResult&gt;This is a response&lt;/tns:getAirportInformationByISOCountryCodeResult&gt;");
sb.append("&lt;/tns:getAirportInformationByISOCountryCodeResponse&gt;");
exchange.getOut().setBody(sb.toString());</pre><p>
					</p><p>As shown above, a string is built here and is used as a reply message of
						the route. It is in line with the message definition of the above wsdl
						file.</p></li><li class="step" title="Step 10"><p>Press <span class="bold"><strong>Ctrl+S</strong></span> to save your Route.</p></li></ol></div></div><div class="section" title="Viewing code and executing the Route"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9584"></a>Viewing code and executing the Route</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Click the <span class="bold"><strong>Code</strong></span> tab at the bottom of the
						design workspace to check the generated code.</p><div class="mediaobject" align="center"><img src="../images/use_case_cexchangepattern_5.png" align="middle"></div><p>As shown above, the route has its message exchange pattern set as
							<code class="code">InOut</code> using the method
							<code class="code">.setExchangePattern(org.apache.camel.ExchangePattern.InOut)</code>.
						In the meantime, a string is created using <code class="code">StringBuilder sb = new
							StringBuilder()</code> at <code class="code">cProcessor_1</code> and is used as the
						reply message via the method <code class="code">exchange.getOut().setBody(
							sb.toString())</code>.</p></li><li class="step" title="Step 2"><p>Press <span class="bold"><strong>F6</strong></span> to execute the Route.</p><p>The server Route gets started.</p></li></ol></div></div><div class="section" title="Creating and sending a request to the server Route and getting a reply"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9622"></a>Creating and sending a request to the server Route and getting a reply</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>In the soapUI, create a Test project and edit a request, as illustrated
						below:</p><div class="mediaobject" align="center"><img src="../images/use_case_cexchangepattern_7.png" align="middle"></div><p>Note that the wsdl file must be same as that configured for <span class="bold"><strong>cCXF</strong></span>, so that the request can be in line with the
						definition of the web service.</p></li><li class="step" title="Step 2"><p>Send the request to the server Route and you can get the reply, as
						illustrated below:</p><div class="mediaobject" align="center"><img src="../images/use_case_cexchangepattern_8.png" align="middle"></div></li></ol></div></div></div></div></body></html>